<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Tarea</title>
  <link rel="stylesheet" href="/static/style.css"/>
  <script>
    function onMemeChange(val) {
      const hb = document.getElementById('hate-block');
      const h1 = document.getElementById('has_hate_1');
      const h0 = document.getElementById('has_hate_0');
      if (val === '1') { hb.style.display = 'block'; if(h1) h1.required = true; if(h0) h0.required = true; }
      else { hb.style.display = 'none'; if(h1) h1.required = false; if(h0) h0.required = false; }
    }
    // Atajos de teclado: 1-7 para meme y odio, Enter para enviar
    document.addEventListener('keyup', (e) => {
      if ('1234567'.includes(e.key)) {
        const meme = document.getElementById('is_meme_' + e.key);
        if(meme) meme.click();
        const hate = document.getElementById('has_hate_' + e.key);
        if(hate) hate.click();
      }
      if (e.key === 'Enter') {
        const b=document.getElementById('submitBtn');
        if(b) b.click();
      }
    });
  </script>
</head>
<body>
  <div class="container">
    <h2>Imagen {{ id }}</h2>

    <div class="image-box">
      <!-- usamos el proxy del backend -->
  <img src="/img/{{ id }}" alt="imagen a etiquetar" loading="eager" decoding="async"
       onerror="this.outerHTML='<p>No se pudo cargar. <a href=&quot;/img/{{ id }}&quot; target=&quot;_blank&quot;>Abrir directo</a></p>'">
    </div>

    <form method="POST" action="/submit">
      <input type="hidden" name="image_id" value="{{ id }}"/>

      <div class="question">
        <label>¿Qué tanto te parece que es un meme?</label>
        <div class="scale">
          {% for i in range(1,8) %}
          <label class="scale-option">
            <input type="radio" name="is_meme" id="is_meme_{{i}}" value="{{i}}" required>
            <span>{{ i }}</span>
          </label>
          {% endfor %}
        </div>
        <div class="scale-legend">
          <span>No es Meme</span>
          <span class="center">Dudoso</span>
          <span>Es Meme</span>
        </div>
      </div>

      <div class="question">
        <label>¿Creés que contiene discurso de odio?</label>
        <div class="scale">
          {% for i in range(1,8) %}
          <label class="scale-option">
            <input type="radio" name="has_hate" id="has_hate_{{i}}" value="{{i}}" required>
            <span>{{ i }}</span>
          </label>
          {% endfor %}
        </div>
        <div class="scale-legend">
          <span>No Contiene</span>
          <span class="center">Dudoso</span>
          <span>Sí, Contiene</span>
        </div>
      </div>

      <button class="btn" id="submitBtn" type="submit">Enviar (Enter)</button>
      <button class="btn" type="button" onclick="window.location.href='/done'">Fin</button>
    </form>
  </div>
</body>
</html>
